cbb19ee92c3dbfae41e83af4926c8317
"use strict";
// CLAUDE.md準拠 型安全性包括テスト（BLUE段階: リファクタリング検証）
Object.defineProperty(exports, "__esModule", { value: true });
const cloudformation_1 = require("../../../src/types/cloudformation");
describe('型安全性包括テスト（CLAUDE.md BLUE段階）', () => {
    // Union型の型ナロウイング検証
    it('should properly narrow union types with type guards', () => {
        const testResources = [
            {
                Type: 'AWS::RDS::DBInstance',
                Properties: { Engine: 'mysql', DBInstanceClass: 'db.t3.micro' }
            },
            {
                Type: 'AWS::Lambda::Function',
                Properties: { Runtime: 'nodejs20.x', MemorySize: 256 }
            },
            {
                Type: 'AWS::EC2::Instance', // 非サポート
                Properties: { InstanceType: 't3.micro' }
            }
        ];
        // 型ガード関数での型ナロウイング
        const rdsResources = testResources.filter(cloudformation_1.isRDSInstance);
        const lambdaResources = testResources.filter(cloudformation_1.isLambdaFunction);
        const supportedResources = testResources.filter(cloudformation_1.isSupportedResource);
        expect(rdsResources).toHaveLength(1);
        expect(lambdaResources).toHaveLength(1);
        expect(supportedResources).toHaveLength(2); // EC2は除外
        // 型安全性：型ナロウイング後はプロパティアクセス可能
        if (rdsResources.length > 0) {
            const rds = rdsResources[0];
            // TypeScriptの型推論でRDSDBInstance型として認識される
            expect(rds.Type).toBe('AWS::RDS::DBInstance');
        }
    });
    // ECS Fargate判定の型安全性
    it('should safely detect Fargate services', () => {
        const fargateService = {
            Type: 'AWS::ECS::Service',
            Properties: {
                LaunchType: 'FARGATE',
                TaskDefinition: 'test-task'
            }
        };
        const ec2Service = {
            Type: 'AWS::ECS::Service',
            Properties: {
                LaunchType: 'EC2'
            }
        };
        expect((0, cloudformation_1.isFargateService)(fargateService)).toBe(true);
        expect((0, cloudformation_1.isFargateService)(ec2Service)).toBe(false);
    });
    // ALB vs NLB判定の型安全性
    it('should safely detect Application Load Balancers', () => {
        const alb = {
            Type: 'AWS::ElasticLoadBalancingV2::LoadBalancer',
            Properties: {
                Type: 'application'
            }
        };
        const nlb = {
            Type: 'AWS::ElasticLoadBalancingV2::LoadBalancer',
            Properties: {
                Type: 'network'
            }
        };
        expect((0, cloudformation_1.isApplicationLoadBalancer)(alb)).toBe(true);
        expect((0, cloudformation_1.isApplicationLoadBalancer)(nlb)).toBe(false);
    });
    // メトリクス型の安全性（しきい値計算）
    it('should ensure metric thresholds are type safe', () => {
        const testMetric = {
            metric_name: 'CPUUtilization',
            namespace: 'AWS/RDS',
            unit: 'Percent',
            description: 'CPU使用率',
            statistic: 'Average',
            recommended_threshold: {
                warning: 70,
                critical: 90
            },
            evaluation_period: 300,
            category: 'Performance',
            importance: 'High'
        };
        // しきい値の妥当性（カスタムマッチャー使用）
        expect(testMetric.recommended_threshold).toHaveValidThreshold();
        // 型安全性：コンパイル時に型チェック済み
        expect(testMetric.statistic).toBe('Average');
        expect(testMetric.category).toBe('Performance');
        expect(testMetric.importance).toBe('High');
    });
    // エラー型の安全性
    it('should define type-safe error interfaces', () => {
        const testErrorDetails = {
            originalError: 'test error',
            fileSize: 1024,
            lineNumber: 42,
            columnNumber: 10,
            filePath: '/path/to/file.yaml',
            duration: 1500
        };
        // 全フィールドが適切な型であることを確認
        expect(typeof testErrorDetails.originalError).toBe('string');
        expect(typeof testErrorDetails.fileSize).toBe('number');
        expect(typeof testErrorDetails.lineNumber).toBe('number');
        expect(typeof testErrorDetails.columnNumber).toBe('number');
        expect(typeof testErrorDetails.filePath).toBe('string');
        expect(typeof testErrorDetails.duration).toBe('number');
    });
    // ResourceType enumの型安全性
    it('should provide type-safe resource type enum', () => {
        // enum値の型安全アクセス
        expect(cloudformation_1.ResourceType.RDS_DB_INSTANCE).toBe('AWS::RDS::DBInstance');
        expect(cloudformation_1.ResourceType.LAMBDA_FUNCTION).toBe('AWS::Lambda::Function');
        expect(cloudformation_1.ResourceType.ECS_SERVICE).toBe('AWS::ECS::Service');
        // Object.values()で全リソースタイプ取得可能
        const allTypes = Object.values(cloudformation_1.ResourceType);
        expect(allTypes).toHaveLength(8);
        expect(allTypes).toContain('AWS::RDS::DBInstance');
        expect(allTypes).toContain('AWS::Lambda::Function');
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUva3lvaGVpL2F3c19jbG91ZF9zdXBwb3J0ZXIvdGVzdHMvdW5pdC90eXBlcy90eXBlLXNhZmV0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQSw0Q0FBNEM7O0FBRTVDLHNFQVMyQztBQUkzQyxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO0lBRTNDLG1CQUFtQjtJQUNuQixFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1FBQzdELE1BQU0sYUFBYSxHQUE2QjtZQUM5QztnQkFDRSxJQUFJLEVBQUUsc0JBQXNCO2dCQUM1QixVQUFVLEVBQUUsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUU7YUFDaEU7WUFDRDtnQkFDRSxJQUFJLEVBQUUsdUJBQXVCO2dCQUM3QixVQUFVLEVBQUUsRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUU7YUFDdkQ7WUFDRDtnQkFDRSxJQUFJLEVBQUUsb0JBQW9CLEVBQUUsUUFBUTtnQkFDcEMsVUFBVSxFQUFFLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRTthQUN6QztTQUNGLENBQUM7UUFFRixrQkFBa0I7UUFDbEIsTUFBTSxZQUFZLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyw4QkFBYSxDQUFDLENBQUM7UUFDekQsTUFBTSxlQUFlLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxpQ0FBZ0IsQ0FBQyxDQUFDO1FBQy9ELE1BQU0sa0JBQWtCLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxvQ0FBbUIsQ0FBQyxDQUFDO1FBRXJFLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4QyxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTO1FBRXJELDRCQUE0QjtR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QUMsQ0FBQztRQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUNuRCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDdEQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9reW9oZWkvYXdzX2Nsb3VkX3N1cHBvcnRlci90ZXN0cy91bml0L3R5cGVzL3R5cGUtc2FmZXR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ0xBVURFLm1k5rqW5ougIOWei+WuieWFqOaAp+WMheaLrOODhuOCueODiO+8iEJMVUXmrrXpmo46IOODquODleOCoeOCr+OCv+ODquODs+OCsOaknOiovO+8iVxuXG5pbXBvcnQgeyBcbiAgQ2xvdWRGb3JtYXRpb25SZXNvdXJjZSwgXG4gIFN1cHBvcnRlZFJlc291cmNlLCBcbiAgUmVzb3VyY2VUeXBlLFxuICBpc1JEU0luc3RhbmNlLFxuICBpc0xhbWJkYUZ1bmN0aW9uLFxuICBpc1N1cHBvcnRlZFJlc291cmNlLFxuICBpc0ZhcmdhdGVTZXJ2aWNlLFxuICBpc0FwcGxpY2F0aW9uTG9hZEJhbGFuY2VyXG59IGZyb20gJy4uLy4uLy4uL3NyYy90eXBlcy9jbG91ZGZvcm1hdGlvbic7XG5pbXBvcnQgeyBNZXRyaWNEZWZpbml0aW9uLCBNZXRyaWNDb25maWcgfSBmcm9tICcuLi8uLi8uLi9zcmMvdHlwZXMvbWV0cmljcyc7XG5pbXBvcnQgeyBFcnJvckRldGFpbHMgfSBmcm9tICcuLi8uLi8uLi9zcmMvdHlwZXMvY29tbW9uJztcblxuZGVzY3JpYmUoJ+Wei+WuieWFqOaAp+WMheaLrOODhuOCueODiO+8iENMQVVERS5tZCBCTFVF5q616ZqO77yJJywgKCkgPT4ge1xuXG4gIC8vIFVuaW9u5Z6L44Gu5Z6L44OK44Ot44Km44Kk44Oz44Kw5qSc6Ki8XG4gIGl0KCdzaG91bGQgcHJvcGVybHkgbmFycm93IHVuaW9uIHR5cGVzIHdpdGggdHlwZSBndWFyZHMnLCAoKSA9PiB7XG4gICAgY29uc3QgdGVzdFJlc291cmNlczogQ2xvdWRGb3JtYXRpb25SZXNvdXJjZVtdID0gW1xuICAgICAge1xuICAgICAgICBUeXBlOiAnQVdTOjpSRFM6OkRCSW5zdGFuY2UnLFxuICAgICAgICBQcm9wZXJ0aWVzOiB7IEVuZ2luZTogJ215c3FsJywgREJJbnN0YW5jZUNsYXNzOiAnZGIudDMubWljcm8nIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFR5cGU6ICdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCBcbiAgICAgICAgUHJvcGVydGllczogeyBSdW50aW1lOiAnbm9kZWpzMjAueCcsIE1lbW9yeVNpemU6IDI1NiB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBUeXBlOiAnQVdTOjpFQzI6Okluc3RhbmNlJywgLy8g6Z2e44K144Od44O844OIXG4gICAgICAgIFByb3BlcnRpZXM6IHsgSW5zdGFuY2VUeXBlOiAndDMubWljcm8nIH1cbiAgICAgIH1cbiAgICBdO1xuXG4gICAgLy8g5Z6L44Ks44O844OJ6Zai5pWw44Gn44Gu5Z6L44OK44Ot44Km44Kk44Oz44KwXG4gICAgY29uc3QgcmRzUmVzb3VyY2VzID0gdGVzdFJlc291cmNlcy5maWx0ZXIoaXNSRFNJbnN0YW5jZSk7XG4gICAgY29uc3QgbGFtYmRhUmVzb3VyY2VzID0gdGVzdFJlc291cmNlcy5maWx0ZXIoaXNMYW1iZGFGdW5jdGlvbik7XG4gICAgY29uc3Qgc3VwcG9ydGVkUmVzb3VyY2VzID0gdGVzdFJlc291cmNlcy5maWx0ZXIoaXNTdXBwb3J0ZWRSZXNvdXJjZSk7XG5cbiAgICBleHBlY3QocmRzUmVzb3VyY2VzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgZXhwZWN0KGxhbWJkYVJlc291cmNlcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdChzdXBwb3J0ZWRSZXNvdXJjZXMpLnRvSGF2ZUxlbmd0aCgyKTsgLy8gRUMy44Gv6Zmk5aSWXG4gICAgXG4gICAgLy8g5Z6L5a6J5YWo5oCn77ya5Z6L44OK44Ot44Km44Kk44Oz44Kw5b6M44Gv44OX44Ot44OR44OG44Kj44Ki44Kv44K744K55Y+v6IO9XG4gICAgaWYgKHJkc1Jlc291cmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCByZHMgPSByZHNSZXNvdXJjZXNbMF07XG4gICAgICAvLyBUeXBlU2NyaXB044Gu5Z6L5o6o6KuW44GnUkRTREJJbnN0YW5jZeWei+OBqOOBl+OBpuiqjeitmOOBleOCjOOCi1xuICAgICAgZXhwZWN0KHJkcy5UeXBlKS50b0JlKCdBV1M6OlJEUzo6REJJbnN0YW5jZScpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gRUNTIEZhcmdhdGXliKTlrprjga7lnovlronlhajmgKdcbiAgaXQoJ3Nob3VsZCBzYWZlbHkgZGV0ZWN0IEZhcmdhdGUgc2VydmljZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgZmFyZ2F0ZVNlcnZpY2U6IENsb3VkRm9ybWF0aW9uUmVzb3VyY2UgPSB7XG4gICAgICBUeXBlOiAnQVdTOjpFQ1M6OlNlcnZpY2UnLFxuICAgICAgUHJvcGVydGllczoge1xuICAgICAgICBMYXVuY2hUeXBlOiAnRkFSR0FURScsXG4gICAgICAgIFRhc2tEZWZpbml0aW9uOiAndGVzdC10YXNrJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBlYzJTZXJ2aWNlOiBDbG91ZEZvcm1hdGlvblJlc291cmNlID0ge1xuICAgICAgVHlwZTogJ0FXUzo6RUNTOjpTZXJ2aWNlJywgXG4gICAgICBQcm9wZXJ0aWVzOiB7XG4gICAgICAgIExhdW5jaFR5cGU6ICdFQzInXG4gICAgICB9XG4gICAgfTtcblxuICAgIGV4cGVjdChpc0ZhcmdhdGVTZXJ2aWNlKGZhcmdhdGVTZXJ2aWNlKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaXNGYXJnYXRlU2VydmljZShlYzJTZXJ2aWNlKSkudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIC8vIEFMQiB2cyBOTELliKTlrprjga7lnovlronlhajmgKdcbiAgaXQoJ3Nob3VsZCBzYWZlbHkgZGV0ZWN0IEFwcGxpY2F0aW9uIExvYWQgQmFsYW5jZXJzJywgKCkgPT4ge1xuICAgIGNvbnN0IGFsYjogQ2xvdWRGb3JtYXRpb25SZXNvdXJjZSA9IHtcbiAgICAgIFR5cGU6ICdBV1M6OkVsYXN0aWNMb2FkQmFsYW5jaW5nVjI6OkxvYWRCYWxhbmNlcicsXG4gICAgICBQcm9wZXJ0aWVzOiB7XG4gICAgICAgIFR5cGU6ICdhcHBsaWNhdGlvbidcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgbmxiOiBDbG91ZEZvcm1hdGlvblJlc291cmNlID0ge1xuICAgICAgVHlwZTogJ0FXUzo6RWxhc3RpY0xvYWRCYWxhbmNpbmdWMjo6TG9hZEJhbGFuY2VyJyxcbiAgICAgIFByb3BlcnRpZXM6IHtcbiAgICAgICAgVHlwZTogJ25ldHdvcmsnXG4gICAgICB9XG4gICAgfTtcblxuICAgIGV4cGVjdChpc0FwcGxpY2F0aW9uTG9hZEJhbGFuY2VyKGFsYikpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGlzQXBwbGljYXRpb25Mb2FkQmFsYW5jZXIobmxiKSkudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIC8vIOODoeODiOODquOCr+OCueWei+OBruWuieWFqOaAp++8iOOBl+OBjeOBhOWApOioiOeul++8iVxuICBpdCgnc2hvdWxkIGVuc3VyZSBtZXRyaWMgdGhyZXNob2xkcyBhcmUgdHlwZSBzYWZlJywgKCkgPT4ge1xuICAgIGNvbnN0IHRlc3RNZXRyaWM6IE1ldHJpY0RlZmluaXRpb24gPSB7XG4gICAgICBtZXRyaWNfbmFtZTogJ0NQVVV0aWxpemF0aW9uJyxcbiAgICAgIG5hbWVzcGFjZTogJ0FXUy9SRFMnLFxuICAgICAgdW5pdDogJ1BlcmNlbnQnLFxuICAgICAgZGVzY3JpcHRpb246ICdDUFXkvb/nlKjnjocnLFxuICAgICAgc3RhdGlzdGljOiAnQXZlcmFnZScsXG4gICAgICByZWNvbW1lbmRlZF90aHJlc2hvbGQ6IHtcbiAgICAgICAgd2FybmluZzogNzAsXG4gICAgICAgIGNyaXRpY2FsOiA5MFxuICAgICAgfSxcbiAgICAgIGV2YWx1YXRpb25fcGVyaW9kOiAzMDAsXG4gICAgICBjYXRlZ29yeTogJ1BlcmZvcm1hbmNlJyxcbiAgICAgIGltcG9ydGFuY2U6ICdIaWdoJ1xuICAgIH07XG5cbiAgICAvLyDjgZfjgY3jgYTlgKTjga7lpqXlvZPmgKfvvIjjgqvjgrnjgr/jg6Djg57jg4Pjg4Hjg6Pjg7zkvb/nlKjvvIlcbiAgICBleHBlY3QodGVzdE1ldHJpYy5yZWNvbW1lbmRlZF90aHJlc2hvbGQpLnRvSGF2ZVZhbGlkVGhyZXNob2xkKCk7XG4gICAgXG4gICAgLy8g5Z6L5a6J5YWo5oCn77ya44Kz44Oz44OR44Kk44Or5pmC44Gr5Z6L44OB44Kn44OD44Kv5riI44G/XG4gICAgZXhwZWN0KHRlc3RNZXRyaWMuc3RhdGlzdGljKS50b0JlKCdBdmVyYWdlJyk7XG4gICAgZXhwZWN0KHRlc3RNZXRyaWMuY2F0ZWdvcnkpLnRvQmUoJ1BlcmZvcm1hbmNlJyk7XG4gICAgZXhwZWN0KHRlc3RNZXRyaWMuaW1wb3J0YW5jZSkudG9CZSgnSGlnaCcpO1xuICB9KTtcblxuICAvLyDjgqjjg6njg7zlnovjga7lronlhajmgKdcbiAgaXQoJ3Nob3VsZCBkZWZpbmUgdHlwZS1zYWZlIGVycm9yIGludGVyZmFjZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgdGVzdEVycm9yRGV0YWlsczogRXJyb3JEZXRhaWxzID0ge1xuICAgICAgb3JpZ2luYWxFcnJvcjogJ3Rlc3QgZXJyb3InLFxuICAgICAgZmlsZVNpemU6IDEwMjQsXG4gICAgICBsaW5lTnVtYmVyOiA0MixcbiAgICAgIGNvbHVtbk51bWJlcjogMTAsXG4gICAgICBmaWxlUGF0aDogJy9wYXRoL3RvL2ZpbGUueWFtbCcsXG4gICAgICBkdXJhdGlvbjogMTUwMFxuICAgIH07XG5cbiAgICAvLyDlhajjg5XjgqPjg7zjg6vjg4njgYzpganliIfjgarlnovjgafjgYLjgovjgZPjgajjgpLnorroqo1cbiAgICBleHBlY3QodHlwZW9mIHRlc3RFcnJvckRldGFpbHMub3JpZ2luYWxFcnJvcikudG9CZSgnc3RyaW5nJyk7XG4gICAgZXhwZWN0KHR5cGVvZiB0ZXN0RXJyb3JEZXRhaWxzLmZpbGVTaXplKS50b0JlKCdudW1iZXInKTtcbiAgICBleHBlY3QodHlwZW9mIHRlc3RFcnJvckRldGFpbHMubGluZU51bWJlcikudG9CZSgnbnVtYmVyJyk7XG4gICAgZXhwZWN0KHR5cGVvZiB0ZXN0RXJyb3JEZXRhaWxzLmNvbHVtbk51bWJlcikudG9CZSgnbnVtYmVyJyk7XG4gICAgZXhwZWN0KHR5cGVvZiB0ZXN0RXJyb3JEZXRhaWxzLmZpbGVQYXRoKS50b0JlKCdzdHJpbmcnKTtcbiAgICBleHBlY3QodHlwZW9mIHRlc3RFcnJvckRldGFpbHMuZHVyYXRpb24pLnRvQmUoJ251bWJlcicpO1xuICB9KTtcblxuICAvLyBSZXNvdXJjZVR5cGUgZW51beOBruWei+WuieWFqOaAp1xuICBpdCgnc2hvdWxkIHByb3ZpZGUgdHlwZS1zYWZlIHJlc291cmNlIHR5cGUgZW51bScsICgpID0+IHtcbiAgICAvLyBlbnVt5YCk44Gu5Z6L5a6J5YWo44Ki44Kv44K744K5XG4gICAgZXhwZWN0KFJlc291cmNlVHlwZS5SRFNfREJfSU5TVEFOQ0UpLnRvQmUoJ0FXUzo6UkRTOjpEQkluc3RhbmNlJyk7XG4gICAgZXhwZWN0KFJlc291cmNlVHlwZS5MQU1CREFfRlVOQ1RJT04pLnRvQmUoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicpO1xuICAgIGV4cGVjdChSZXNvdXJjZVR5cGUuRUNTX1NFUlZJQ0UpLnRvQmUoJ0FXUzo6RUNTOjpTZXJ2aWNlJyk7XG4gICAgXG4gICAgLy8gT2JqZWN0LnZhbHVlcygp44Gn5YWo44Oq44K944O844K544K/44Kk44OX5Y+W5b6X5Y+v6IO9XG4gICAgY29uc3QgYWxsVHlwZXMgPSBPYmplY3QudmFsdWVzKFJlc291cmNlVHlwZSk7XG4gICAgZXhwZWN0KGFsbFR5cGVzKS50b0hhdmVMZW5ndGgoOCk7XG4gICAgZXhwZWN0KGFsbFR5cGVzKS50b0NvbnRhaW4oJ0FXUzo6UkRTOjpEQkluc3RhbmNlJyk7XG4gICAgZXhwZWN0KGFsbFR5cGVzKS50b0NvbnRhaW4oJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicpO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==