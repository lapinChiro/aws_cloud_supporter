1bd7d8764416413e49208bddbdacbf46
"use strict";
// CLAUDE.mdÊ∫ñÊã†ResourceExtractorÊúÄÈÅ©Âåñ„ÉÜ„Çπ„ÉàÔºàBLUEÊÆµÈöé: „É™„Éï„Ç°„ÇØ„Çø„É™„É≥„Ç∞Ê§úË®ºÔºâ
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const extractor_1 = require("../../../src/core/extractor");
const parser_1 = require("../../../src/core/parser");
const path_1 = __importDefault(require("path"));
describe('ResourceExtractorÊúÄÈÅ©ÂåñÔºàCLAUDE.md: BLUEÊÆµÈöéÔºâ', () => {
    let parser;
    let extractor;
    beforeEach(() => {
        parser = new parser_1.TemplateParser();
        extractor = new extractor_1.ResourceExtractor();
    });
    // ÂÆüÈöõ„ÅÆCloudFormation„ÉÜ„É≥„Éó„É¨„Éº„Éà„Åß„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
    it('should work with real CloudFormation templates', async () => {
        const realTemplates = [
            'serverless-api-sam.yaml',
            'container-microservices-ecs.yaml',
            'web-application-stack.yaml'
        ];
        for (const templateFile of realTemplates) {
            const templatePath = path_1.default.join(__dirname, '../../../examples', templateFile);
            const template = await parser.parse(templatePath);
            const result = extractor.extract(template);
            expect(result.totalCount).toBeGreaterThan(0);
            expect(result.extractionTimeMs).toBeLessThan(1000); // ÂÆü„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅØ1Áßí‰ª•ÂÜÖ
            console.log(`üìä ${templateFile}: ${result.supported.length}/${result.totalCount} „Çµ„Éù„Éº„ÉàÂØæË±° (${result.extractionTimeMs}ms)`);
        }
    });
    // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©ÂåñÁ¢∫Ë™ç
    it('should demonstrate optimized performance characteristics', async () => {
        const basicTemplatePath = path_1.default.join(__dirname, '../../../examples/basic-cloudformation.yaml');
        const template = await parser.parse(basicTemplatePath);
        // Ë§áÊï∞ÂõûÂÆüË°å„Åß„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂÆâÂÆöÊÄß
        const results = [];
        for (let i = 0; i < 10; i++) {
            const startTime = performance.now();
            const result = extractor.extract(template);
            const duration = performance.now() - startTime;
            results.push({
                duration,
                supportedCount: result.supported.length,
                totalCount: result.totalCount
            });
        }
        // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂÆâÂÆöÊÄß
        const avgDuration = results.reduce((sum, r) => sum + r.duration, 0) / results.length;
        expect(avgDuration).toBeLessThan(100); // Âπ≥Âùá100ms‰ª•‰∏ã
        // ÁµêÊûú‰∏ÄË≤´ÊÄß
        const firstResult = results[0];
        results.forEach(result => {
            expect(result.supportedCount).toBe(firstResult.supportedCount);
            expect(result.totalCount).toBe(firstResult.totalCount);
        });
    });
    // „É°„É¢„É™ÂäπÁéáÊÄß„ÅÆË©≥Á¥∞Á¢∫Ë™ç
    it('should maintain excellent memory efficiency', async () => {
        const basicTemplatePath = path_1.default.join(__dirname, '../../../examples/basic-cloudformation.yaml');
        const template = await parser.parse(basicTemplatePath);
        const memoryBefore = process.memoryUsage();
        // 1000ÂõûÊäΩÂá∫Ôºà„É°„É¢„É™„É™„Éº„ÇØÁ¢∫Ë™çÔºâ
        for (let i = 0; i < 1000; i++) {
            extractor.extract(template);
        }
        const memoryAfter = process.memoryUsage();
        const memoryDelta = (memoryAfter.heapUsed - memoryBefore.heapUsed) / 1024 / 1024;
        expect(memoryDelta).toBeLessThan(10); // „É°„É¢„É™Â¢óÂä†10MB‰ª•‰∏ã
        console.log(`üß† „É°„É¢„É™ÂäπÁéá: ${memoryDelta.toFixed(1)}MBÂ¢óÂä†Ôºà1000ÂõûÊäΩÂá∫Ôºâ`);
    });
    // ÂûãÂÆâÂÖ®ÊÄß„ÅÆË©≥Á¥∞Á¢∫Ë™çÔºàCLAUDE.md: Type-Driven DevelopmentÔºâ
    it('should demonstrate enhanced type safety', async () => {
        const basicTemplatePath = path_1.default.join(__dirname, '../../../examples/basic-cloudformation.yaml');
        const template = await parser.parse(basicTemplatePath);
        const result = extractor.extract(template);
        // SupportedResourceÂûã„ÅÆÂûãÂÆâÂÖ®ÊÄß
        result.supported.forEach(resource => {
            // LogicalId„Éó„É≠„Éë„ÉÜ„Ç£„ÅÆÂ≠òÂú®Á¢∫Ë™ç
            expect(resource.LogicalId).toBeDefined();
            expect(typeof resource.LogicalId).toBe('string');
            // Type „Éó„É≠„Éë„ÉÜ„Ç£„ÅÆÂûãÂÆâÂÖ®ÊÄß
            expect(resource.Type).toBeDefined();
            expect(typeof resource.Type).toBe('string');
            // Properties „ÅÆÂûãÂÆâÂÖ®ÊÄßÔºàunknown„Å†„ÅåÂ≠òÂú®Á¢∫Ë™çÂèØËÉΩÔºâ
            expect(resource.Properties === undefined || typeof resource.Properties === 'object').toBe(true);
        });
        // unsupportedÈÖçÂàó„ÅÆÂûãÂÆâÂÖ®ÊÄß
        result.unsupported.forEach(logicalId => {
            expect(typeof logicalId).toBe('string');
            expect(logicalId.length).toBeGreaterThan(0);
        });
    });
    // „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®„ÅÆÁµ±ÂêàÁ¢∫Ë™ç
    it('should handle edge cases gracefully', () => {
        // Á©∫„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà
        const emptyTemplate = {
            AWSTemplateFormatVersion: "2010-09-09",
            Resources: {}
        };
        const result = extractor.extract(emptyTemplate);
        expect(result.supported).toHaveLength(0);
        expect(result.unsupported).toHaveLength(0);
        expect(result.totalCount).toBe(0);
        expect(result.extractionTimeMs).toBeGreaterThanOrEqual(0);
        // ÂûãÂÆâÂÖ®ÊÄßÔºöÁ©∫ÈÖçÂàó„Åß„ÇÇÈÅ©Âàá„Å™Âûã
        expect(Array.isArray(result.supported)).toBe(true);
        expect(Array.isArray(result.unsupported)).toBe(true);
    });
    // ExtractionPerformanceMonitorÁµ±Âêà„ÉÜ„Çπ„Éà
    it('should integrate with performance monitoring', async () => {
        const basicTemplatePath = path_1.default.join(__dirname, '../../../examples/basic-cloudformation.yaml');
        const template = await parser.parse(basicTemplatePath);
        const performanceResult = extractor_1.ExtractionPerformanceMonitor.measureExtractionPerformance(extractor, template);
        expect(performanceResult.result).toBeDefined();
        expect(performanceResult.memoryUsage).toBeGreaterThanOrEqual(0);
        expect(['A', 'B', 'C', 'F']).toContain(performanceResult.performanceGrade);
        console.log(`‚ö° „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπË©ï‰æ°: ${performanceResult.performanceGrade} („É°„É¢„É™: ${performanceResult.memoryUsage.toFixed(1)}MB)`);
    });
    // ÂÆüÈöõ„ÅÆ„Çµ„Éù„Éº„ÉàÂØæË±°„É™„ÇΩ„Éº„ÇπÊ§úË®º
    it('should accurately detect supported resources in real templates', async () => {
        const samTemplatePath = path_1.default.join(__dirname, '../../../examples/serverless-api-sam.yaml');
        const template = await parser.parse(samTemplatePath);
        const result = extractor.extract(template);
        // SAM„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆ„Çµ„Éù„Éº„ÉàÂØæË±°Á¢∫Ë™ç
        const resourceTypes = result.supported.map(r => r.Type);
        const expectedSupportedTypes = [
            'AWS::Serverless::Api',
            'AWS::Serverless::Function',
            'AWS::DynamoDB::Table'
        ];
        expectedSupportedTypes.forEach(expectedType => {
            expect(resourceTypes.some(type => type === expectedType)).toBe(true);
        });
        console.log(`üìã SAM„ÉÜ„É≥„Éó„É¨„Éº„Éà: „Çµ„Éù„Éº„ÉàÂØæË±°„É™„ÇΩ„Éº„ÇπÂûã ${[...new Set(resourceTypes)].join(', ')}`);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUva3lvaGVpL2F3c19jbG91ZF9zdXBwb3J0ZXIvdGVzdHMvdW5pdC9jb3JlL2V4dHJhY3Rvci1vcHRpbWl6YXRpb24udGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUEseURBQXlEOzs7OztBQUV6RCwyREFBOEY7QUFDOUYscURBQTBEO0FBQzFELGdEQUF3QjtBQUV4QixRQUFRLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO0lBQ3ZELElBQUksTUFBc0IsQ0FBQztJQUMzQixJQUFJLFNBQTRCLENBQUM7SUFFakMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLE1BQU0sR0FBRyxJQUFJLHVCQUFjLEVBQUUsQ0FBQztRQUM5QixTQUFTLEdBQUcsSUFBSSw2QkFBaUIsRUFBRSxDQUFDO0lBQ3RDLENBQUMsQ0FBQyxDQUFDO0lBRUgsZ0NBQWdDO0lBQ2hDLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLElBQUksRUFBRTtRQUM5RCxNQUFNLGFBQWEsR0FBRztZQUNwQix5QkFBeUI7WUFDekIsa0NBQWtDO1lBQ2xDLDRCQUE0QjtTQUM3QixDQUFDO1FBRUYsS0FBSyxNQUFNLFlBQVksSUFBSSxhQUFhLEVBQUUsQ0FBQztZQUN6QyxNQUFNLFlBQVksR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxtQkFBbUIsRUFBRSxZQUFZLENBQUMsQ0FBQztZQUU3RSxNQUFNLFFBQVEsR0FBRyxNQUFNLE1BQU0sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDbEQsTUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUUzQyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsZUFBZTtZQUVuRSxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sWUFB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LElBQUksQ0FBQyxDQUFDO1FBQ3hELE1BQU0sc0JBQXNCLEdBQUc7WUFDN0Isc0JBQXNCO1lBQ3RCLDJCQUEyQjtZQUMzQixzQkFBc0I7U0FDdkIsQ0FBQztRQUVGLHNCQUFzQixDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUM1QyxNQUFNLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDckYsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9reW9oZWkvYXdzX2Nsb3VkX3N1cHBvcnRlci90ZXN0cy91bml0L2NvcmUvZXh0cmFjdG9yLW9wdGltaXphdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENMQVVERS5tZOa6luaLoFJlc291cmNlRXh0cmFjdG9y5pyA6YGp5YyW44OG44K544OI77yIQkxVReautemajjog44Oq44OV44Kh44Kv44K/44Oq44Oz44Kw5qSc6Ki877yJXG5cbmltcG9ydCB7IFJlc291cmNlRXh0cmFjdG9yLCBFeHRyYWN0aW9uUGVyZm9ybWFuY2VNb25pdG9yIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvcmUvZXh0cmFjdG9yJztcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2NvcmUvcGFyc2VyJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5kZXNjcmliZSgnUmVzb3VyY2VFeHRyYWN0b3LmnIDpganljJbvvIhDTEFVREUubWQ6IEJMVUXmrrXpmo7vvIknLCAoKSA9PiB7XG4gIGxldCBwYXJzZXI6IFRlbXBsYXRlUGFyc2VyO1xuICBsZXQgZXh0cmFjdG9yOiBSZXNvdXJjZUV4dHJhY3RvcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBwYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoKTtcbiAgICBleHRyYWN0b3IgPSBuZXcgUmVzb3VyY2VFeHRyYWN0b3IoKTtcbiAgfSk7XG5cbiAgLy8g5a6f6Zqb44GuQ2xvdWRGb3JtYXRpb27jg4bjg7Pjg5fjg6zjg7zjg4jjgafjga7li5XkvZznorroqo1cbiAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggcmVhbCBDbG91ZEZvcm1hdGlvbiB0ZW1wbGF0ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVhbFRlbXBsYXRlcyA9IFtcbiAgICAgICdzZXJ2ZXJsZXNzLWFwaS1zYW0ueWFtbCcsXG4gICAgICAnY29udGFpbmVyLW1pY3Jvc2VydmljZXMtZWNzLnlhbWwnLFxuICAgICAgJ3dlYi1hcHBsaWNhdGlvbi1zdGFjay55YW1sJ1xuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IHRlbXBsYXRlRmlsZSBvZiByZWFsVGVtcGxhdGVzKSB7XG4gICAgICBjb25zdCB0ZW1wbGF0ZVBhdGggPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vLi4vLi4vZXhhbXBsZXMnLCB0ZW1wbGF0ZUZpbGUpO1xuICAgICAgXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHBhcnNlci5wYXJzZSh0ZW1wbGF0ZVBhdGgpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gZXh0cmFjdG9yLmV4dHJhY3QodGVtcGxhdGUpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnRvdGFsQ291bnQpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXh0cmFjdGlvblRpbWVNcykudG9CZUxlc3NUaGFuKDEwMDApOyAvLyDlrp/jg4bjg7Pjg5fjg6zjg7zjg4jjga8x56eS5Lul5YaFXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OKICR7dGVtcGxhdGVGaWxlfTogJHtyZXN1bHQuc3VwcG9ydGVkLmxlbmd0aH0vJHtyZXN1bHQudG90YWxDb3VudH0g44K144Od44O844OI5a++6LGhICgke3Jlc3VsdC5leHRyYWN0aW9uVGltZU1zfW1zKWApO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8g44OR44OV44Kp44O844Oe44Oz44K55pyA6YGp5YyW56K66KqNXG4gIGl0KCdzaG91bGQgZGVtb25zdHJhdGUgb3B0aW1pemVkIHBlcmZvcm1hbmNlIGNoYXJhY3RlcmlzdGljcycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBiYXNpY1RlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLi8uLi9leGFtcGxlcy9iYXNpYy1jbG91ZGZvcm1hdGlvbi55YW1sJyk7XG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwYXJzZXIucGFyc2UoYmFzaWNUZW1wbGF0ZVBhdGgpO1xuICAgIFxuICAgIC8vIOikh+aVsOWbnuWun+ihjOOBp+OBruODkeODleOCqeODvOODnuODs+OCueWuieWumuaAp1xuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gZXh0cmFjdG9yLmV4dHJhY3QodGVtcGxhdGUpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgZHVyYXRpb24sXG4gICAgICAgIHN1cHBvcnRlZENvdW50OiByZXN1bHQuc3VwcG9ydGVkLmxlbmd0aCxcbiAgICAgICAgdG90YWxDb3VudDogcmVzdWx0LnRvdGFsQ291bnRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIOODkeODleOCqeODvOODnuODs+OCueWuieWumuaAp1xuICAgIGNvbnN0IGF2Z0R1cmF0aW9uID0gcmVzdWx0cy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgci5kdXJhdGlvbiwgMCkgLyByZXN1bHRzLmxlbmd0aDtcbiAgICBleHBlY3QoYXZnRHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDApOyAvLyDlubPlnYcxMDBtc+S7peS4i1xuXG4gICAgLy8g57WQ5p6c5LiA6LKr5oCnXG4gICAgY29uc3QgZmlyc3RSZXN1bHQgPSByZXN1bHRzWzBdO1xuICAgIHJlc3VsdHMuZm9yRWFjaChyZXN1bHQgPT4ge1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdXBwb3J0ZWRDb3VudCkudG9CZShmaXJzdFJlc3VsdC5zdXBwb3J0ZWRDb3VudCk7XG4gICAgICBleHBlY3QocmVzdWx0LnRvdGFsQ291bnQpLnRvQmUoZmlyc3RSZXN1bHQudG90YWxDb3VudCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIOODoeODouODquWKueeOh+aAp+OBruips+e0sOeiuuiqjVxuICBpdCgnc2hvdWxkIG1haW50YWluIGV4Y2VsbGVudCBtZW1vcnkgZWZmaWNpZW5jeScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBiYXNpY1RlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLi8uLi9leGFtcGxlcy9iYXNpYy1jbG91ZGZvcm1hdGlvbi55YW1sJyk7XG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwYXJzZXIucGFyc2UoYmFzaWNUZW1wbGF0ZVBhdGgpO1xuXG4gICAgY29uc3QgbWVtb3J5QmVmb3JlID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpO1xuICAgIFxuICAgIC8vIDEwMDDlm57mir3lh7rvvIjjg6Hjg6Ljg6rjg6rjg7zjgq/norroqo3vvIlcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykge1xuICAgICAgZXh0cmFjdG9yLmV4dHJhY3QodGVtcGxhdGUpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBtZW1vcnlBZnRlciA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKTtcbiAgICBjb25zdCBtZW1vcnlEZWx0YSA9IChtZW1vcnlBZnRlci5oZWFwVXNlZCAtIG1lbW9yeUJlZm9yZS5oZWFwVXNlZCkgLyAxMDI0IC8gMTAyNDtcbiAgICBcbiAgICBleHBlY3QobWVtb3J5RGVsdGEpLnRvQmVMZXNzVGhhbigxMCk7IC8vIOODoeODouODquWil+WKoDEwTULku6XkuItcbiAgICBjb25zb2xlLmxvZyhg8J+noCDjg6Hjg6Ljg6rlirnnjoc6ICR7bWVtb3J5RGVsdGEudG9GaXhlZCgxKX1NQuWil+WKoO+8iDEwMDDlm57mir3lh7rvvIlgKTtcbiAgfSk7XG5cbiAgLy8g5Z6L5a6J5YWo5oCn44Gu6Kmz57Sw56K66KqN77yIQ0xBVURFLm1kOiBUeXBlLURyaXZlbiBEZXZlbG9wbWVudO+8iVxuICBpdCgnc2hvdWxkIGRlbW9uc3RyYXRlIGVuaGFuY2VkIHR5cGUgc2FmZXR5JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGJhc2ljVGVtcGxhdGVQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uLy4uL2V4YW1wbGVzL2Jhc2ljLWNsb3VkZm9ybWF0aW9uLnlhbWwnKTtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHBhcnNlci5wYXJzZShiYXNpY1RlbXBsYXRlUGF0aCk7XG4gICAgY29uc3QgcmVzdWx0ID0gZXh0cmFjdG9yLmV4dHJhY3QodGVtcGxhdGUpO1xuICAgIFxuICAgIC8vIFN1cHBvcnRlZFJlc291cmNl5Z6L44Gu5Z6L5a6J5YWo5oCnXG4gICAgcmVzdWx0LnN1cHBvcnRlZC5mb3JFYWNoKHJlc291cmNlID0+IHtcbiAgICAgIC8vIExvZ2ljYWxJZOODl+ODreODkeODhuOCo+OBruWtmOWcqOeiuuiqjVxuICAgICAgZXhwZWN0KHJlc291cmNlLkxvZ2ljYWxJZCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzb3VyY2UuTG9naWNhbElkKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIFxuICAgICAgLy8gVHlwZSDjg5fjg63jg5Hjg4bjgqPjga7lnovlronlhajmgKdcbiAgICAgIGV4cGVjdChyZXNvdXJjZS5UeXBlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXNvdXJjZS5UeXBlKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIFxuICAgICAgLy8gUHJvcGVydGllcyDjga7lnovlronlhajmgKfvvIh1bmtub3du44Gg44GM5a2Y5Zyo56K66KqN5Y+v6IO977yJXG4gICAgICBleHBlY3QocmVzb3VyY2UuUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiByZXNvdXJjZS5Qcm9wZXJ0aWVzID09PSAnb2JqZWN0JykudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIC8vIHVuc3VwcG9ydGVk6YWN5YiX44Gu5Z6L5a6J5YWo5oCnXG4gICAgcmVzdWx0LnVuc3VwcG9ydGVkLmZvckVhY2gobG9naWNhbElkID0+IHtcbiAgICAgIGV4cGVjdCh0eXBlb2YgbG9naWNhbElkKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIGV4cGVjdChsb2dpY2FsSWQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIOOCqOODqeODvOODj+ODs+ODieODquODs+OCsOOBqOOBrue1seWQiOeiuuiqjVxuICBpdCgnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2VzIGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgLy8g56m644Gu44OG44Oz44OX44Os44O844OIXG4gICAgY29uc3QgZW1wdHlUZW1wbGF0ZSA9IHtcbiAgICAgIEFXU1RlbXBsYXRlRm9ybWF0VmVyc2lvbjogXCIyMDEwLTA5LTA5XCIsXG4gICAgICBSZXNvdXJjZXM6IHt9XG4gICAgfTtcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBleHRyYWN0b3IuZXh0cmFjdChlbXB0eVRlbXBsYXRlKTtcbiAgICBcbiAgICBleHBlY3QocmVzdWx0LnN1cHBvcnRlZCkudG9IYXZlTGVuZ3RoKDApO1xuICAgIGV4cGVjdChyZXN1bHQudW5zdXBwb3J0ZWQpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICBleHBlY3QocmVzdWx0LnRvdGFsQ291bnQpLnRvQmUoMCk7XG4gICAgZXhwZWN0KHJlc3VsdC5leHRyYWN0aW9uVGltZU1zKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuXG4gICAgLy8g5Z6L5a6J5YWo5oCn77ya56m66YWN5YiX44Gn44KC6YGp5YiH44Gq5Z6LXG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LnN1cHBvcnRlZCkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LnVuc3VwcG9ydGVkKSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgLy8gRXh0cmFjdGlvblBlcmZvcm1hbmNlTW9uaXRvcue1seWQiOODhuOCueODiFxuICBpdCgnc2hvdWxkIGludGVncmF0ZSB3aXRoIHBlcmZvcm1hbmNlIG1vbml0b3JpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgYmFzaWNUZW1wbGF0ZVBhdGggPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vLi4vLi4vZXhhbXBsZXMvYmFzaWMtY2xvdWRmb3JtYXRpb24ueWFtbCcpO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgcGFyc2VyLnBhcnNlKGJhc2ljVGVtcGxhdGVQYXRoKTtcbiAgICBcbiAgICBjb25zdCBwZXJmb3JtYW5jZVJlc3VsdCA9IEV4dHJhY3Rpb25QZXJmb3JtYW5jZU1vbml0b3IubWVhc3VyZUV4dHJhY3Rpb25QZXJmb3JtYW5jZShleHRyYWN0b3IsIHRlbXBsYXRlKTtcbiAgICBcbiAgICBleHBlY3QocGVyZm9ybWFuY2VSZXN1bHQucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChwZXJmb3JtYW5jZVJlc3VsdC5tZW1vcnlVc2FnZSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICBleHBlY3QoWydBJywgJ0InLCAnQycsICdGJ10pLnRvQ29udGFpbihwZXJmb3JtYW5jZVJlc3VsdC5wZXJmb3JtYW5jZUdyYWRlKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pqhIOODkeODleOCqeODvOODnuODs+OCueipleS+oTogJHtwZXJmb3JtYW5jZVJlc3VsdC5wZXJmb3JtYW5jZUdyYWRlfSAo44Oh44Oi44OqOiAke3BlcmZvcm1hbmNlUmVzdWx0Lm1lbW9yeVVzYWdlLnRvRml4ZWQoMSl9TUIpYCk7XG4gIH0pO1xuXG4gIC8vIOWun+mam+OBruOCteODneODvOODiOWvvuixoeODquOCveODvOOCueaknOiovFxuICBpdCgnc2hvdWxkIGFjY3VyYXRlbHkgZGV0ZWN0IHN1cHBvcnRlZCByZXNvdXJjZXMgaW4gcmVhbCB0ZW1wbGF0ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc2FtVGVtcGxhdGVQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uLy4uL2V4YW1wbGVzL3NlcnZlcmxlc3MtYXBpLXNhbS55YW1sJyk7XG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwYXJzZXIucGFyc2Uoc2FtVGVtcGxhdGVQYXRoKTtcbiAgICBjb25zdCByZXN1bHQgPSBleHRyYWN0b3IuZXh0cmFjdCh0ZW1wbGF0ZSk7XG5cbiAgICAvLyBTQU3jg4bjg7Pjg5fjg6zjg7zjg4jjga7jgrXjg53jg7zjg4jlr77osaHnorroqo1cbiAgICBjb25zdCByZXNvdXJjZVR5cGVzID0gcmVzdWx0LnN1cHBvcnRlZC5tYXAociA9PiByLlR5cGUpO1xuICAgIGNvbnN0IGV4cGVjdGVkU3VwcG9ydGVkVHlwZXMgPSBbXG4gICAgICAnQVdTOjpTZXJ2ZXJsZXNzOjpBcGknLFxuICAgICAgJ0FXUzo6U2VydmVybGVzczo6RnVuY3Rpb24nLCBcbiAgICAgICdBV1M6OkR5bmFtb0RCOjpUYWJsZSdcbiAgICBdO1xuXG4gICAgZXhwZWN0ZWRTdXBwb3J0ZWRUeXBlcy5mb3JFYWNoKGV4cGVjdGVkVHlwZSA9PiB7XG4gICAgICBleHBlY3QocmVzb3VyY2VUeXBlcy5zb21lKHR5cGUgPT4gdHlwZSA9PT0gZXhwZWN0ZWRUeXBlKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKGDwn5OLIFNBTeODhuODs+ODl+ODrOODvOODiDog44K144Od44O844OI5a++6LGh44Oq44K944O844K55Z6LICR7Wy4uLm5ldyBTZXQocmVzb3VyY2VUeXBlcyldLmpvaW4oJywgJyl9YCk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9